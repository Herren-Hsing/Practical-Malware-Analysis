rule Lab11_01exe {
   meta:
      description = "Lab11-01.exe"
   strings:
      $s1 = "gina.dll" fullword ascii
      $s2 = "msgina32.dll" fullword ascii
      $s3 = "DllRegister" fullword ascii
      $s4 = "DllUnregister" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 200KB and
      all of them
}

rule Lab11_02dll {
   meta:
      description = "Lab11-02.dll"
   strings:
      $s1 = "spoolvxx32.dll" fullword ascii
      $s2 = "THEBAT.EXE" fullword ascii
      $s3 = "MSIMN.EXE" fullword ascii 
      $s4 = "Lab11-02.dll" fullword ascii
      $s5 = "\\Lab11-02.ini" fullword ascii
      $s6 = "AppInit_DLLs" fullword ascii 
      $s7 = "RCPT TO: <" fullword ascii 
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 60KB and
      all of them
}

rule Lab11_03dll {
   meta:
      description = "Lab11-03.dll"
   strings:
      $s1 = "C:\\WINDOWS\\System32\\kernel64x.dll" fullword ascii
      $s2 = "Lab1103dll.dll" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}

rule Lab11_03exe {
   meta:
      description = "Lab11-03.exe"
   strings:
      $s1 = "C:\\WINDOWS\\System32\\inet_epar32.dll" fullword ascii
      $s2 = "cisvc.exe" fullword ascii
      $s3 = "Lab11-03.dll" fullword ascii
      $s4 = "net start cisvc" fullword ascii
      $s5 = "command.com" fullword ascii
      $s6 = "COMSPEC" fullword ascii 
      $s7 = "zzz69806582" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}