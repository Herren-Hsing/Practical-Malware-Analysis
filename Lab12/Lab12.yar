rule Lab12_01exe {
   meta:
      description = " Lab12-01.exe"
   strings:
      $s1 = "Lab12-01.dll" fullword ascii
      $s2 = "YYh `@" fullword ascii 
      $s3 = "RichLu" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}
rule Lab12_01dll {
   meta:
      description = "Lab12-01.dll"
   strings:
      $s1 = "Press OK to reboot" fullword ascii
      $s2 = ">.>4><>Z>`>q>" fullword ascii
      $s3 = "4b4h4v4" fullword ascii
      $s4 = "0K0d0n0y0" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}
rule Lab12_02 {
   meta:
      description = "Lab12-02.exe"
   strings:
      $s1 = "\\svchost.exe" fullword ascii
	$s2 = "wqstLKla143$a7(354 -a'4/\"5(./a\" --LKAAA" fullword ascii
condition:
	uint16(0) == 0x5a4d and 
	uint32(uint32(0x3c))==0x00004550 and filesize < 200KB and 
	all of them
}
rule Lab12_03{
   meta:
      description = "Lab12-03.exe"
   strings:
      $s1 = "practicalmalwareanalysis.log" fullword ascii
      $s2 = "[Window: " fullword ascii
      $s3 = "[BACKSPACE]" fullword ascii
      $s4 = "[ENTER]" fullword ascii
      $s5 = "[CTRL]" fullword ascii
      $s6 = "[SHIFT]" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 70KB and
      all of them
}
rule Lab12_04 {
   meta:
      description = "Lab12-04.exe"
   strings:
      $s1 = "\\system32\\wupdmgrd.exe" fullword ascii
      $s2 = "\\system32\\wupdmgr.exe" fullword ascii
      $s3 = "http://www.practicalmalwareanalysis.com/updater.exe" fullword ascii
      $s4 = "\\winup.exe" fullword ascii
      $s5 = "SeDebugPrivilege" fullword ascii 
      $s6 = "<not real>" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}