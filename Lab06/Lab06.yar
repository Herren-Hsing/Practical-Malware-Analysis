rule Lab06_01{
   meta:
      description = "Lab06-01.exe"
   strings:
      $s1 = "Success: Internet Connection" fullword ascii
      $s2 = "Error 1.1: No Internet" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}
rule Lab06_02 {
   meta:
      description = "Lab06-02.exe"
   strings:
      $s1 ="Error 1.1: No Internet" fullword ascii 
      $s2 = "Error 2.1: Fail to OpenUrl" fullword ascii
      $s3 = "Error 2.2: Fail to ReadFile" fullword ascii
      $s4 = "Error 2.3: Fail to get command" fullword ascii
      $s5 = "Success: Internet Connection" fullword ascii
      $s6 = "Success: Parsed command is %c" fullword ascii
      $s7 = "http://www.practicalmalwareanalysis.com/cc.htm" fullword ascii
      $s8 = "Internet Explorer 7.5/pma" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}
rule Lab06_03 {
   meta:
      description = "Lab06-03.exe"
   strings:
      $s1 = "C:\\Temp\\cc.exe" fullword ascii
      $s2 = "http://www.practicalmalwareanalysis.com/cc.htm" fullword ascii
      $s3 = "Error 3.2: Not a valid command provided" fullword ascii
      $s4 = "Error 2.3: Fail to get command" fullword ascii
      $s5 = "Error 2.1: Fail to OpenUrl" fullword ascii
      $s6 = "Error 2.2: Fail to ReadFile" fullword ascii
      $s7 = "Error 1.1: No Internet" fullword ascii
      $s8 = "Error 3.1: Could not set Registry value" fullword ascii
      $s9 = "Success: Internet Connection" fullword ascii
      $s10 = "Success: Parsed command is %c" fullword ascii
      $s11 = "Internet Explorer 7.5/pma" fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}
rule Lab06_04 {
   meta:
      description = "Lab06-04.exe"
   strings:
      $s1 = "C:\\Temp\\cc.exe" fullword ascii
      $s2 = "http://www.practicalmalwareanalysis.com/cc.htm" fullword ascii
      $s3 = "Error 3.2: Not a valid command provided" fullword ascii
      $s4 = "Error 2.3: Fail to get command" fullword ascii
      $s5 = "Error 2.1: Fail to OpenUrl" fullword ascii
      $s6 = "Error 2.2: Fail to ReadFile" fullword ascii
      $s7 = "Error 1.1: No Internet" fullword ascii
      $s8 = "Error 3.1: Could not set Registry value" fullword ascii
      $s9 = "Success: Internet Connection" fullword ascii
      $s10 = "Success: Parsed command is %c" fullword ascii
      $s11 = "Internet Explorer 7.50/pma%d"  fullword ascii
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 100KB and
      all of them
}