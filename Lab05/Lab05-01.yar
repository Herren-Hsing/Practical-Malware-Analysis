rule Lab05_01 {
   meta:
      description = "Lab05-01.dll"
   strings:
      $s1 = "\\cmd.exe /c " fullword ascii
      $s2 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion" fullword ascii
      $s3 = "Uninject '%s' From Process '%s' " fullword ascii
      $s4 = "error on get process info. " fullword ascii
      $s5 = "Process '%s' Not Found ,Inject Failed" fullword ascii
      $s6 = "Inject '%s' To Process '%s' Failed" fullword ascii
      $s8 = "Inject '%s' To’%x’ Process '%s'" fullword ascii
      $s9 = "\\command.exe /c " fullword ascii
      
   condition:
      uint16(0) == 0x5a4d and 
      uint32(uint32(0x3c))==0x00004550 and filesize < 400KB and
      6 of them
}