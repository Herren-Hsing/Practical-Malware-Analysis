import idaapi
import idautils

# 指定要查找的函数名
target_function_name = "sub_10004E79"

# 获取函数的起始地址
target_function_ea = idc.get_name_ea_simple(target_function_name)

if target_function_ea != idc.BADADDR:
    print(f"函数 {target_function_name} 的地址: {target_function_ea:X}")
    
    # 遍历函数中的指令并列出
    for ea in idautils.FuncItems(target_function_ea):
        disasm = idc.GetDisasm(ea)
        print(f"{ea:X}: {disasm}")
else:
    print(f"没有找到函数 {target_function_name}")
