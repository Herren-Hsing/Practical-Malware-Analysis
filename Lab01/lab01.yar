rule Lab01_01_exe {
meta:
	description = "This is for Lab01-01.exe"
strings:
	$string1 = "kerne132.dll" fullword
	$string2 = "kernel32.dll" fullword 
	$string3 = "C:\\windows\\system32\\kerne132.dll" fullword
	$string4 = "C:\\Windows\\System32\\Kernel32.dll" fullword
	$string5 = "Lab01-01.dll" fullword 
	$string6 = "FindNextFileA" fullword
	$string7 = "FindFirstFileA" fullword
	$string8 = "CopyFileA" fullword
condition:
	uint16(0) == 0x5A4D and 
	uint32(uint32(0x3C)) == 0x00004550 and
	filesize < 10MB and
	all of them
}
rule Lab01_01_dll {
meta:
	description = "This is for Lab01-01.dll"
strings:
	$string1 = "127.26.152.13" fullword ascii
	$string2 = "sleep" fullword ascii
	$string3 = "CreateProcessA" fullword ascii
	$string4 = "exec" fullword ascii
condition:
	uint16(0) == 0x5A4D and 
	uint32(uint32(0x3C)) == 0x00004550 and
	filesize < 10MB and
	all of them
}
rule Lab01_02_exe {
meta:
	description = "This is for Lab01-02.exe"
strings:
	$string1 = "MalService" fullword ascii
	$string2 = "InternetOpenA" fullword ascii
	$string3 = "CreateServiceA" fullword ascii
	$hex_com = {68 74 74 70 3A 2F 2F 77 FF B7 BF DD 00  2E 6D 1E 77 61 72 65 61 6E 07 79 73 69 73 62 6F 6F 6B 2E 63 6F FF DB DB 6F 6D}
condition:
	uint16(0) == 0x5A4D and 
	uint32(uint32(0x3C)) == 0x00004550 and
	filesize < 10MB and
	all of them
}
rule Lab01_03_exe {
meta:
	description = "This is for Lab01-03.exe"
strings:
	$string1 = "ole32.vd" fullword ascii
	$string2 = "}OLEAUTLA" fullword ascii
	$string3 = "_getmas" fullword ascii
	$string4 = "fmod" fullword ascii
	$string5 = "|P2r3Us" fullword ascii
	$string6 = "p|vuy" fullword ascii
condition:
	uint16(0) == 0x5A4D and 
	uint32(uint32(0x3C)) == 0x00004550 and
	filesize < 10MB and
	all of them
}
rule Lab01_04_exe {
meta:
	description = "This is for Lab01-04.exe"
strings:
	$string1 = "\\system32\\wupdmgr.exe" fullword ascii
	$string2 = "http://www.practicalmalwareanalysis.com/updater.exe" fullword ascii
	$string3 = "WinExec" fullword ascii
	$string4 = "ADVAPI32.dll" fullword ascii
	$string5 = "URLDownloadToFileA" fullword ascii
condition:
	uint16(0) == 0x5A4D and 
	uint32(uint32(0x3C)) == 0x00004550 and
	filesize < 10MB and
	all of them
}